# üéØ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã Browser Cache Headers "Expire 1y"

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –±–∏–ª–¥–∞ Next.js –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `Expire 1y` –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- –ë—Ä–∞—É–∑–µ—Ä—ã –∫—ç—à–∏—Ä—É—é—Ç HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞ **1 –≥–æ–¥**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –≤–∏–¥—è—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –¥–∞–∂–µ –ø–æ—Å–ª–µ `revalidatePath`
- –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –¥–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∞–π—Ç–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ

### 1. **–ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `next.config.js`**

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `next.config.js` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  async headers() {
    return [
      // –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–≥–ª–∞–≤–Ω–∞—è, –º–æ–¥–µ–ª–∏, –∫–æ–Ω—Ç–∞–∫—Ç—ã)
      {
        source: '/((?!api|_next/static|_next/image|favicon.ico|uploads).*)',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=300, stale-while-revalidate=86400',
          },
        ],
      },
      // –°—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–¥–µ–ª–µ–π - –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π –∫—ç—à
      {
        source: '/models/:path*',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=120, stale-while-revalidate=600',
          },
        ],
      },
      // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) - –¥–æ–ª–≥–∏–π –∫—ç—à
      {
        source: '/uploads/:path*',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=31536000, immutable',
          },
        ],
      },
    ]
  },
}
```

### 2. **Route Segment Config –≤ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö**

–£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ—Ä–æ—Ç–∫–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Ä–µ–≤–∞–ª–∏–¥–∞—Ü–∏–∏:

- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞** (`/`): `revalidate = 300` (5 –º–∏–Ω—É—Ç)
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–æ–¥–µ–ª–µ–π** (`/models`): `revalidate = 120` (2 –º–∏–Ω—É—Ç—ã)  
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–æ–¥–µ–ª–∏** (`/models/[id]`): `revalidate = 120` (2 –º–∏–Ω—É—Ç—ã)

### 3. **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤**

#### `public, max-age=300, stale-while-revalidate=86400`
- `public` - –º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º –∏ CDN
- `max-age=300` - —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ 5 –º–∏–Ω—É—Ç
- `stale-while-revalidate=86400` - –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ 24 —á–∞—Å–æ–≤, –Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤ —Ñ–æ–Ω–µ

#### `public, max-age=120, stale-while-revalidate=600`  
- –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü –º–æ–¥–µ–ª–µ–π - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
- –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ 10 –º–∏–Ω—É—Ç

#### `public, max-age=31536000, immutable`
- –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - –∫—ç—à –Ω–∞ –≥–æ–¥, —Ç–∞–∫ –∫–∞–∫ —Ñ–∞–π–ª—ã –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:

‚úÖ **–ë—Ä–∞—É–∑–µ—Ä—ã –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–∂–¥—ã–µ 2-5 –º–∏–Ω—É—Ç**  
‚úÖ **–ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ—è–≤—è—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 2 –º–∏–Ω—É—Ç**  
‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∞–π—Ç–∞ –≤–∏–¥–Ω—ã —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç**  
‚úÖ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∫—ç—à–∏—Ä—É—é—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ**  
‚úÖ **`revalidatePath` —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ**

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –î–æ | –ü–æ—Å–ª–µ |
|---|---|
| `Expire 1y` - –∫—ç—à –Ω–∞ –≥–æ–¥ | `max-age=120-300` - –∫—ç—à 2-5 –º–∏–Ω—É—Ç |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ –≤–∏–¥–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º | –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∏–¥–Ω—ã —á–µ—Ä–µ–∑ 2-5 –º–∏–Ω—É—Ç |
| `revalidatePath` –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç | `revalidatePath` —Ä–∞–±–æ—Ç–∞–µ—Ç |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç**: `npm run build`
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∏–ª–¥**: –±–æ–ª—å—à–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `Expire 1y`
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å**: `npm start`
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏** –≤ DevTools ‚Üí Network
5. **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å** - –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã

## üîÑ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Nginx –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏:

```nginx
location / {
    proxy_pass http://localhost:3000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    
    # –ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å expires –∏–ª–∏ add_header Cache-Control –¥–ª—è HTML
    # Next.js —É–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
}
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:
- –í—Ä–µ–º—è –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ —Å–∞–π—Ç–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∞–π—Ç–∞
- –†–∞–±–æ—Ç—É –∫–Ω–æ–ø–∫–∏ "–û–±–Ω–æ–≤–∏—Ç—å –∫—ç—à" –≤ –∞–¥–º–∏–Ω–∫–µ
- Response Headers –≤ –±—Ä–∞—É–∑–µ—Ä–µ 